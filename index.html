<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Writing Club</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="icon.png">
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
</head>

<body>
    <header id="head">
        <h1 id="myh1"><i>Writing Club</i></h1>
        <h3 id="myh3">To write the assignment and record work for school and College students. To need time for
            writing,A minimum two week.Writing fee for Record work : Rs.150 per record and Assignment work :Rs.10 per
            (Note:This service is only for sick students on exams time)
        </h3>
    </header>
    <hr>
    <main>
        <section id="section">
            <h2 id="formhead">Details Form</h2>
            <form id="form" name="submit-to-google-sheet1">
                <center>
                    <table>
                        <tr>
                            <td><label for="Name">Name:</label></td>
                            <td><input type="text" id="Name" name="name" required placeholder="Enter Your Name"></td>
                        </tr>
                        <tr>
                            <td><label for="Age">Age:</label></td>
                            <td><input type="number" id="Age" name="age" required placeholder="Enter Your Age" min="18"
                                    max="25">
                            </td>
                        </tr>
                        <tr>
                            <td><label for="phone">Phone Number:</label></td>
                            <td><input type="tel" id="phone" name="phone" required placeholder="Enter Your PhoneNumber">
                            </td>
                        </tr>
                        <tr>
                            <td><label for="College">College:</label></td>
                            <td><input type="text" id="College" name="college" required
                                    placeholder="Enter Your College Name" minlength="5" maxlength="40"></td>
                        </tr>
                        <tr>
                            <td><label for="Email">Email:</label></td>
                            <td><input type="email" id="Email" name="email" required placeholder="Enter Your Email">
                            </td>
                        </tr>
                        <tr>
                            <td><label for="Dept">Dept:</label></td>
                            <td><input type="text" id="Dept" name="dept" required placeholder="Enter Your Dept"
                                    minlength="2" maxlength="8"></td>
                        </tr>
                        <tr>
                            <td><label for="select">Select:</label></td>
                            <td><select name="select" id="select">
                                    <option value="record">Record</option>
                                    <option value="assignment">Assignment</option>
                                </select></td>
                        </tr>
                        <tr>
                            <td><label for="time">Duration:</label></td>
                            <td><select name="time" id="time">
                                    <option value="2-week">2-Week</option>
                                    <option value="3-week">3-Week</option>
                                </select></td>
                        </tr>
                        <tr>
                            <td><label for="count">Count:</label></td>
                            <td><input type="number" min="1" max="2" id="count" required name="count"
                                    placeholder="Enter WritingWork Count"></td>
                        </tr>
                        <tr>
                            <td><label for="check">BrownSheet:</label></td>
                            <td><input type="checkbox" id="check"></td>
                        </tr>
                        <tr>
                            <td><label for="sample">Sample Type:</label></td>
                            <td><select name="sample" id="sample">
                                    <option value="offline">Offline</option>
                                    <option value="online">Online</option>

                                </select></td>
                        </tr>
                        <tr>
                            <td><label>Total Amount:</label></td>
                            <td>
                                <div id="amount"><a onclick="view()"><input type="text" id="AMOUNT" name="amount"
                                            readonly value="Press here View Amount"></a></div>
                            </td>
                        </tr>

                    </table>
                </center>
                <button class="submit" id="mysubmit" onclick="sendMail()">Submit</button><br>
                <span id="result"></span>
            </form>

        </section>
    </main>
    <hr>
    <footer id="foot">
        <h1 id="foothead">Writing Club</h1>
        <div id="service">
            <h2>Services</h2>
            <h3>Assignment Writing</h3>
            <h3>Record Writing</h3>
        </div>
        <hr>
        <div id="help">
            <h3>Ask any help</h3>
            <label for="Gmail">Gmail:</label><a href="https://mail.google.com/mail/u/0/?tab=rm&ogbl#inbox"
                target="_blank" id="Gmail" title="Gmail">selva91823@gmail.com</a>
        </div>
        <hr>
        <div id="feed back">
            <h3>feedback</h3>
            <form name="submit-to-google-sheet2">
                <center>
                    <table>
                        <tr>
                            <td><label for="fname">Name:</label></td>
                            <td><input type="text" id="fname" required name="Fname" placeholder="Enter Your Name"></td>

                        </tr>
                        <tr>
                            <td><label for="femail">Email:</label></td>
                            <td><input type="email" id="femail" required name="Femail" placeholder="Enter Your Email">
                            </td>
                        </tr>
                        <tr>
                            <td><label for="fphone">Mobile Number:</label></td>
                            <td><input type="tel" id="fphone" required name="Fphone" placeholder="Enter your Number">
                            </td>
                        </tr>
                        <tr>
                            <td><label for="fcomment">feedback:</label></td>
                            <td><textarea id="fcomment" placeholder="Type your message here..." rows="5" cols="20"
                                    name="Fcomment"></textarea></td>
                        </tr>
                    </table>
                    <button class="submit">Submit</button><br><br><br>

                </center>
            </form>
        </div>
    </footer>
    <script>
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwQUpLLI-TvlvDeo7H87jURh-VTJywLvFHUb1nc1qPvFErlMF6wF4tOlFiUHm0_TVkzXQ/exec'
        const form = document.forms['submit-to-google-sheet1']
        const result = document.getElementById("result");
        form.addEventListener('submit', e => {
            e.preventDefault()
            fetch(scriptURL, { method: 'POST', body: new FormData(form) })
                .then(response => {
                    result.textContent = "Data successfully Submit";

                    setTimeout(function () {
                        result.textContent = "";
                    }, 2000)
                    form.reset();
                })
                .catch(error => {
                    result.textContent = "Error";
                })
        })
    </script>
    <script>
        const scriptURL1 = 'https://script.google.com/macros/s/AKfycbzF1hzf5DXYdh3ufs9IX50-rvsnbIdeLs-RFoXYw49JhW5vz4gDhuPKmFEkcv9yzl8/exec'
        const form1 = document.forms['submit-to-google-sheet2']
        form1.addEventListener('submit', e => {
            e.preventDefault()
            fetch(scriptURL1, { method: 'POST', body: new FormData(form1) })
                .then(response => {
                    window.alert("Thanks for your feed back");
                    form1.reset();

                })
                .catch(error => {
                    window.alert("Error");
                })
        })
    </script>
    <script src="script.js"></script>
    <script>

        function sendMail() {
            (function () {
                emailjs.init("3NlLDAlluPb9_5XOW"); //Account public key
            })();

            let NAme = document.getElementById("Name").value;

            let phonenum = document.getElementById("phone").value;
            let wdept = document.getElementById("Dept").value;

            let brownSh = document.getElementById("check");

            brownSh.checked ? brownSh = "true" : brownSh = "false";
            let Sample = document.getElementById("sample").value;
            var AMount = document.getElementById("AMOUNT").value;
            let Time = document.getElementById("time").value;
            let College = document.getElementById("College").value;
            let WOrk = document.getElementById("select").value;
            let COunt = document.getElementById("count").value;

            if (NAme != "" && phonenum != "" && College != "" && !COunt == "") {
                var params = {
                    Name: document.getElementById("Name").value,
                    subject: document.getElementById("select").value,
                    Email: document.getElementById("Email").value,
                    message: `Name:${NAme}/phoneNumber:${phonenum}/Work:${WOrk}/Count:${COunt}/College:${College}/dept:${wdept}/brownSheet:${brownSh}/Time:${Time}/Sample:${Sample}/Amount:${AMount}`,

                };
                var serviceID = "service_3na2787"; //Email service ID
                var templateID = "template_c6padhf"; //Email template ID

                emailjs.send(serviceID, templateID, params)
                .then( res => {
                    window.alert("Email sent successfully");
                })
                .catch( error => {
                    window.alert("Error");
                });
            }
            else {
                window.alert("Enter the details");
            }


        }

    </script>
</body>

</html>